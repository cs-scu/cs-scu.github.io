# نام گردش کار که در تب Actions گیت‌هاب نمایش داده می‌شود
name: Deploy static content from /src to Pages

# چه زمانی این گردش کار اجرا شود؟
on:
  push:
    branches: ["main"] # هر بار که کدی به برنچ main پوش شود
  workflow_dispatch: # به شما اجازه می‌دهد تا به صورت دستی آن را اجرا کنید

# سطح دسترسی‌های مورد نیاز برای این گردش کار
permissions:
  contents: read   # اجازه خواندن محتوای ریپازیتوری را می‌دهد
  pages: write    # اجازه نوشتن و دیپلوی در GitHub Pages را می‌دهد
  id-token: write # اجازه احراز هویت برای دیپلوی را می‌دهد

# جلوگیری از اجرای همزمان چند دیپلوی
concurrency:
  group: "pages"
  cancel-in-progress: false # اگر دیپلوی در حال اجرا باشد، منتظر بمان تا تمام شود

# کارها (Jobs)یی که باید انجام شوند
jobs:
  deploy: # نام این کار "deploy" است
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }} # URL نهایی را در خروجی نمایش می‌دهد
    runs-on: ubuntu-latest # روی یک ماشین مجازی با سیستم‌عامل اوبونتو اجرا می‌شود
    steps: # مراحل انجام کار
      - name: Checkout
        uses: actions/checkout@v4 # کد شما را از ریپازیتوری دانلود می‌کند

      - name: Setup Pages
        uses: actions/configure-pages@v5 # گیت‌هاب پیجز را برای دیپلوی آماده می‌کند

      - name: Upload artifact
        uses: actions/upload-pages-artifact@v3 # محتوای سایت را به عنوان یک "آرتیفکت" آپلود می‌کند
        with:
          path: './src' # مشخص می‌کند که محتوای پوشه src باید آپلود شود

      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4 # آرتیفکت آپلود شده را روی گیت‌هاب پیجز دیپلوی می‌کند